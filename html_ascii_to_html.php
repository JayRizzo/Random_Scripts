<?php
define('CHARSET', 'UTF-8');
// Reference: https://dev.w3.org/html5/html-author/charref 
// I believe a lot of these are now using HTML-5 References IE - HTML ENTITY: '&trade;' 
// Most of these are replacing with HEX CODE / HTML CODE / HTML ENTITY

// ============================================================================
// STRIP BAD BEHAVIOUR - CURLY APOSTROPHE - NEW LINES - COPYRIGHT - REGISTERED - TM - NBSP; ETC.
// ============================================================================
$str_find_array    = array(       '?',   "\xc2\xbf", "\xc3\x80", "\xc3\x81", "\xc3\x82", "\xc3\x83", "\xc3\x84", "\xc3\x85", "\xc3\x86", "\xc3\x87", "\xc3\x88", "\xc3\x89", "\xc3\x8a", "\xc3\x8b", "\xc3\x8c", "\xc3\x8d", "\xc3\x8e", "\xc3\x8f", "\xc3\x90", "\xc3\x91", "\xc3\x92", "\xc3\x93", "\xc3\x94", "\xc3\x95", "\xc3\x96", "\xc3\x97", "\xc3\x98", "\xc3\x99", "\xc3\x9a", "\xc3\x9b", "\xc3\x9c", "\xc3\x9d", "\xc3\x9e", "\xc3\x9f", "\xc3\xa0", "\xc3\xa1", "\xc3\xa2", "\xc3\xa3", "\xc3\xa4", "\xc3\xa5", "\xc3\xa6", "\xc3\xa7", "\xc3\xa8", "\xc3\xa9", "\xc3\xaa", "\xc3\xab", "\xc3\xac", "\xc3\xad", "\xc3\xae", "\xc3\xaf", "\xc3\xb0", "\xc3\xb1", "\xc3\xb2", "\xc3\xb3", "\xc3\xb4", "\xc3\xb5", "\xc3\xb6", "\xc3\xb7", "\xc3\xb8", "\xc3\xb9", "\xc3\xba", "\xc3\xbb", "\xc3\xbc", "\xc3\xbd", "\xc3\xbe", "\xc3\xbf",  "\xc2\xad", "\xe2\x80\xa8",     "\xC2\x96",  "\xc2\x99",  "\xef\xa0\x80", "\xef\xa0\x81", "\xef\xa0\x82", "\xef\xa0\x83", "\xef\xa0\x84", "\xef\xa0\x85", "\xef\xa0\x86", "\xef\xa0\x87", "\xef\xa0\x88", "\xef\xa0\x89", "\xef\xa0\x8a", "\xef\xa0\x8b", "\xef\xa0\x8c", "\xef\xa0\x8d", "\xef\xa0\x8e", "\xef\xa0\x8f", "\xef\xa0\x90", "\xef\xa0\x91", "\xef\xa0\x92", "\xef\xa0\x93", "\xef\xa0\x94", "\xef\xa0\x95", "\xef\xa0\x96", "\xef\xa0\x97", "\xef\xa0\x98", "\xef\xa0\x99", "\xef\xa0\x9a", "\xef\xa0\x9b", "\xef\xa0\x9c", "\xef\xa0\x9d", "\xef\xa0\x9e", "\xef\xa0\x9f", "\xef\xa0\xa0", "\xef\xa0\xa1", "\xef\xa0\xa2", "\xef\xa0\xa3", "\xef\xa0\xa4", "\xef\xa0\xa5", "\xef\xa0\xa6", "\xef\xa0\xa7", "\xef\xa0\xa8", "\xef\xa0\xa9", "\xef\xa0\xaa", "\xef\xa0\xab", "\xef\xa0\xac", "\xef\xa0\xad", "\xef\xa0\xae", "\xef\xa0\xaf", "\xef\xa0\xb0", "\xef\xa0\xb1", "\xef\xa0\xb2", "\xef\xa0\xb3", "\xef\xa0\xb4", "\xef\xa0\xb5", "\xef\xa0\xb6", "\xef\xa0\xb7", "\xef\xa0\xb8", "\xef\xa0\xb9", "\xef\xa0\xba", "\xef\xa0\xbb", "\xef\xa0\xbc", "\xef\xa0\xbd", "\xef\xa0\xbe", "\xef\xa0\xbf", "\xef\xa1\x80", "\xef\xa1\x81", "\xef\xa1\x82", "\xef\xa1\x83", "\xef\xa1\x84", "\xef\xa1\x85", "\xef\xa1\x86", "\xef\xa1\x87", "\xef\xa1\x88", "\xef\xa1\x89", "\xef\xa1\x8a", "\xef\xa1\x8b", "\xef\xa1\x8c", "\xef\xa1\x8d", "\xef\xa1\x8e", "\xef\xa1\x8f", "\xef\xa1\x90", "\xef\xa1\x91", "\xef\xa1\x92", "\xef\xa1\x93", "\xef\xa1\x94", "\xef\xa1\x95", "\xef\xa1\x96", "\xef\xa1\x97", "\xef\xa1\x98", "\xef\xa1\x99", "\xef\xa1\x9a", "\xef\xa1\x9b", "\xef\xa1\x9c", "\xef\xa1\x9d", "\xef\xa1\x9e", "\xef\xa1\x9f", "\xef\xa1\xa0", "\xef\xa1\xa1", "\xef\xa1\xa2", "\xef\xa1\xa3", "\xef\xa1\xa4", "\xef\xa1\xa5", "\xef\xa1\xa6", "\xef\xa1\xa7", "\xef\xa1\xa8", "\xef\xa1\xa9", "\xef\xa1\xaa", "\xef\xa1\xab", "\xef\xa1\xac", "\xef\xa1\xad", "\xef\xa1\xae", "\xef\xa1\xaf", "\xef\xa1\xb0", "\xef\xa1\xb1", "\xef\xa1\xb2", "\xef\xa1\xb3", "\xef\xa1\xb4", "\xef\xa1\xb5", "\xef\xa1\xb6", "\xef\xa1\xb7", "\xef\xa1\xb8", "\xef\xa1\xb9", "\xef\xa1\xba", "\xef\xa1\xbb", "\xef\xa1\xbc", "\xef\xa1\xbd", "\xef\xa1\xbe", "\xef\xa1\xbf", "\xef\xa2\x80", "\xef\xa2\x81", "\xef\xa2\x82", "\xef\xa2\x83", "\xef\xa2\x84", "\xef\xa2\x85", "\xef\xa2\x86", "\xef\xa2\x87", "\xef\xa2\x88", "\xef\xa2\x89", "\xef\xa2\x8a", "\xef\xa2\x8b", "\xef\xa2\x8c", "\xef\xa2\x8d", "\xef\xa2\x8e", "\xef\xa2\x8f", "\xef\xa2\x90", "\xef\xa2\x91", "\xef\xa2\x92", "\xef\xa2\x93", "\xef\xa2\x94", "\xef\xa2\x95", "\xef\xa2\x96", "\xef\xa2\x97", "\xef\xa2\x98", "\xef\xa2\x99", "\xef\xa2\x9a", "\xef\xa2\x9b", "\xef\xa2\x9c", "\xef\xa2\x9d", "\xef\xa2\x9e", "\xef\xa2\x9f", "\xef\xa2\xa0", "\xef\xa2\xa1", "\xef\xa2\xa2", "\xef\xa2\xa3", "\xef\xa2\xa4", "\xef\xa2\xa5", "\xef\xa2\xa6", "\xef\xa2\xa7", "\xef\xa2\xa8", "\xef\xa2\xa9", "\xef\xa2\xaa", "\xef\xa2\xab", "\xef\xa2\xac", "\xef\xa2\xad", "\xef\xa2\xae", "\xef\xa2\xaf", "\xef\xa2\xb0", "\xef\xa2\xb1", "\xef\xa2\xb2", "\xef\xa2\xb3", "\xef\xa2\xb4", "\xef\xa2\xb5", "\xef\xa2\xb6", "\xef\xa2\xb7", "\xef\xa2\xb8", "\xef\xa2\xb9", "\xef\xa2\xba", "\xef\xa2\xbb", "\xef\xa2\xbc", "\xef\xa2\xbd", "\xef\xa2\xbe", "\xef\xa2\xbf", "\xef\xa3\x80", "\xef\xa3\x81", "\xef\xa3\x82", "\xef\xa3\x83", "\xef\xa3\x84", "\xef\xa3\x85", "\xef\xa3\x86", "\xef\xa3\x87", "\xef\xa3\x88", "\xef\xa3\x89", "\xef\xa3\x8a", "\xef\xa3\x8b", "\xef\xa3\x8c", "\xef\xa3\x8d", "\xef\xa3\x8e", "\xef\xa3\x8f", "\xef\xa3\x90", "\xef\xa3\x91", "\xef\xa3\x92", "\xef\xa3\x93", "\xef\xa3\x94", "\xef\xa3\x95", "\xef\xa3\x96", "\xef\xa3\x97", "\xef\xa3\x98", "\xef\xa3\x99", "\xef\xa3\x9a", "\xef\xa3\x9b", "\xef\xa3\x9c", "\xef\xa3\x9d", "\xef\xa3\x9e", "\xef\xa3\x9f", "\xef\xa3\xa0", "\xef\xa3\xa1", "\xef\xa3\xa2", "\xef\xa3\xa3", "\xef\xa3\xa4", "\xef\xa3\xa5", "\xef\xa3\xa6", "\xef\xa3\xa7", "\xef\xa3\xa8", "\xef\xa3\xa9", "\xef\xa3\xaa", "\xef\xa3\xab", "\xef\xa3\xac", "\xef\xa3\xad", "\xef\xa3\xae", "\xef\xa3\xaf", "\xef\xa3\xb0", "\xef\xa3\xb1", "\xef\xa3\xb2", "\xef\xa3\xb3", "\xef\xa3\xb4", "\xef\xa3\xb5", "\xef\xa3\xb6", "\xef\xa3\xb7", "\xef\xa3\xb8", "\xef\xa3\xb9", "\xef\xa3\xba", "\xef\xa3\xbb", "\xef\xa3\xbc", "\xef\xa3\xbd", "\xef\xa3\xbe", "\xef\xa3\xbf", "\xef\xbb\xbf",                 ' ',       '♪',      '♭',        '¼',        '½',        '⅓',        '⅔',        '⅕',        '⅖',        '⅗',        '⅘',        '⅙',        '⅚',        '⅛',        '⅜',        '⅝',        '¾',        '⅞',    'Ⓢ',        '|',       '?',        '$',      '!',      ';',          'à',        '·',      '¶',      '¯',       '«',      'ª',      '¨',      '§',        '¦',      '¥',         '¤',       '£',      '¢',       '¡',      '"',      '″',   '‘',       '`',      '°',      '¢',        '∞',        '¬',       '*',            ',',        '…',        '–',       '—',        '%',      '“',      '”',      '„',       '˝',      '•',  '’', chr(145), chr(146), chr(147), chr(148), chr(151), '&#8222;', '&#8220;', '&#146;',       '©',     '®',     'Ⓡ',    'ⓡ',       '™', '~\x{00a0}~siu',    "\r\n",      "\n", ' ');
$str_replace_array = array( '&quest;',     '&#xBF;',   '&#xC0;',   '&#xC1;',   '&#xC2;',   '&#xC3;',   '&#xC4;',   '&#xC5;',   '&#xC6;',   '&#xC7;',   '&#xC8;',   '&#xC9;',   '&#xCA;',   '&#xCB;',   '&#xCC;',   '&#xCD;',   '&#xCE;',   '&#xCF;',   '&#xD0;',   '&#xD1;',   '&#xD2;',   '&#xD3;',   '&#xD4;',   '&#xD5;',   '&#xD6;',   '&#xD7;',   '&#xD8;',   '&#xD9;',   '&#xDA;',   '&#xDB;',   '&#xDC;',   '&#xDD;',   '&#xDE;',   '&#xDF;',   '&#xE0;',   '&#xE1;',   '&#xE2;',   '&#xE3;',   '&#xE4;',   '&#xE5;',   '&#xE6;',   '&#xE7;',   '&#xE8;',   '&#xE9;',   '&#xEA;',   '&#xEB;',   '&#xEC;',   '&#xED;',   '&#xEE;',   '&#xEF;',   '&#xF0;',   '&#xF1;',   '&#xF2;',   '&#xF3;',   '&#xF4;',   '&#xF5;',   '&#xF6;',   '&#xF7;',   '&#xF8;',   '&#xF9;',   '&#xFA;',   '&#xFB;',   '&#xFC;',   '&#xFD;',   '&#xFE;',   '&#xFF;',          '',             '',             '',          '',              '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',            '',              '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',             '',            '&nbsp;',  '&sung;', '&flat;', '&frac14;', '&frac12;', '&frac13;', '&frac23;', '&frac15;', '&frac25;', '&frac35;', '&frac45;', '&frac16;', '&frac56;', '&frac18;', '&frac38;', '&frac58;', '&frac34;', '&frac78;',  '&oS;', '&verbar;',       '?', '&dollar;', '&excl;',      ';',   '&agrave;', '&middot;', '&para;', '&macr;', '&laquo;', '&ordf;',  '&uml;', '&sect;', '&brvbar;',  '&yen;',  '&curren;', '&pound;', '&cent;', '&iexcl;', '&quot;', '&quot;',  '\'', '&grave;',  '&deg;', '&cent;',  '&infin;',    '&not;',   '&ast;',      '&comma;', '&hellip;',  '&ndash;', '&mdash;', '&percnt;', '&quot;', '&quot;', '&quot;',  '&quot;', '&bull;', '\'',      "'",      "'",      '"',      '"',      '-',       '"',       '"',      "'",  '&copy;', '&reg;', '&reg;', '&reg;', '&trade;',              '',   '<br/>',   '<br/>', ' ');

$product_title = trim(mb_convert_encoding(str_replace($str_find_array, $str_replace_array, strip_tags( $FIELD_TO_FIX ) ), 'UTF-8', mb_detect_encoding(strip_tags($FIELD_TO_FIX))));

?>
